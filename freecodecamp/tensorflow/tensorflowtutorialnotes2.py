# -*- coding: utf-8 -*-
"""TensorflowTutorialNotes2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/14BhBtcEI_X6XHTgRB1YG91RSYiV4ZqlB

#Part 2 of the tensorflow tutorial notes
# Setup 

lets again start with the imports, device, and distribution strategy on TPU. If you did not understand any of the above lines then look at part 1 again.

Also I forgot to write it out previously but take a look at https://www.tensorflow.org/tutorials
"""

# Commented out IPython magic to ensure Python compatibility.
# %tensorflow_version 2.x
import tensorflow as tf
import os

## Set device
resolver = tf.distribute.cluster_resolver.TPUClusterResolver(tpu='')
tf.config.experimental_connect_to_cluster(resolver)
# This is the TPU initialization code that has to be at the beginning.
tf.tpu.experimental.initialize_tpu_system(resolver)
print("All devices: ", tf.config.list_logical_devices('TPU'))

# set device as tpu 
tf.device('/TPU:0')

# distrubtion stratgey
tfd = tf.distribute.TPUStrategy(resolver)

"""# Tensorflow Core Learning Algos

- linear regression
- classification
- clustering
- HMM -> Hidden Markov Models

these are the fundamental algos that can be expanded on.

## Linear Regression

The most basic form of machine learning and is used to predict numeric values.

https://www.tensorflow.org/tutorials/estimator/linear

as a summary linear regression which is a basic form of ml where you linear corespondance between datapoints.

below I have draw a graph
"""

import matplotlib.pyplot as plt
import numpy as np

x = [1, 2, 5, 7, 8]
y = [3, 10, 11, 15, 18]
plt.plot(x, y, 'ro')
plt.axis([0, 10, 0, 20]) # 0 to 10 x axis and 0 to 20 y axis

"""as you can see there is already a linear corespondance and you can draw a line through it to predict y points for x values with a straight line

the formula would be y = mx + b and here below is an example of the line of best fit for the above graph
"""

plt.plot(x, y, 'ro')
plt.axis([0, 10, 0, 20])

plt.plot(np.unique(x), np.poly1d(np.polyfit(x, y, 1))(np.unique(x)))
plt.show()

"""The blue line can be used in the future to predict more values

### Linear Regression Project

This is a simple project to use linear regression.
"""

!pip install -q sklearn

from __future__ import absolute_import, division, print_function, unicode_literals

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from IPython.display import clear_output
from six.moves import urllib

import tensorflow.compat.v2.feature_column as fc

"""Lets load the data set from a a few files for ***The Titanic*** and who is going to die or surrive."""

dftrain = pd.read_csv('https://storage.googleapis.com/tf-datasets/titanic/train.csv') # training data
dfeval = pd.read_csv('https://storage.googleapis.com/tf-datasets/titanic/eval.csv') # testing data

dftrain.head()

dfeval.head()

ytrain = dftrain.pop('survived') # removed and stored survided in ytain 
yeval = dfeval.pop('survived') # removed and stroed survived in yeval

dftrain.head()

dfeval.head()

"""lets describe all the data after viewing them"""

dftrain.describe()

dftrain.shape

"""as we can see we have 627 stuff / entries and 9 features"""

dftrain.age.hist(bins=20)

